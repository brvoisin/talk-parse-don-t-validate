<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="style.css" />
    <title>Et si on Ã©vitait les bugs avant mÃªme dâ€™exÃ©cuter le codeÂ ?</title>
  </head>

  <body>
    <div class="line top"></div>
    <div class="line bottom"></div>
    <div class="line left"></div>
    <div class="line right"></div>
    <div class="reveal">
      <div class="slides">
        <section>
          <h1 class="title r-fit-text">
            Et si on Ã©vitait les bugs avant<br />
            mÃªme dâ€™exÃ©cuter le codeÂ ?
          </h1>
          <p class="subtitle">Utilisez pleinement la puissance des types</p>
          <p class="speaker">Bruno Voisin</p>
          <p class="event">
            ğŸ™ï¸
            <a
              href="https://craftsrecords.org/le-tremplin-bordelais"
              rel="external"
              class="discret"
            >
              Le Tremplin Bordelais
            </a>
            2025
          </p>
          <img
            src="assets/images/crafts-records.svg"
            alt="Crafts Records"
            class="crafts-records"
          />
        </section>

        <section>
          <h2 class="hidden">Je me prÃ©sente ğŸ‘‹</h2>
          <div class="speaker-card">
            <img
              src="assets/images/bruno.png"
              alt="Bruno Voisin"
              class="portrait"
            />
            <div class="info">
              <div class="name">Bruno Voisin</div>
              <ul>
                <li class="location">Bordeaux</li>
                <li class="organization">
                  <a href="https://sinch.com" rel="external" class="discret">
                    Sinch
                  </a>
                </li>
                <li class="position">Senior Software Engineer</li>
                <li class="experience">13 ans dâ€™expÃ©rience en dÃ©veloppement</li>
              </ul>
            </div>
          </div>
          <div class="logos">
            <div class="logo-item">
              <div class="yaal">
                <img src="assets/images/yaal.svg" alt="Yaal" />
              </div>
            </div>
            <div class="logo-item">
              <img src="assets/images/sinch.svg" alt="Sinch" class="sinch" />
            </div>
          </div>
        </section>

        <section>
          <h2 class="hidden">PrÃ©sentation du sujet</h2>
          <div class="preview">
            <div class="link">
              <a
                href="https://lexi-lambda.github.io/blog/2019/11/05/parse-don-t-validate/"
                rel="external"
              >
                lexi-lambda.github.io
              </a>
            </div>
            <div class="title">
              <a
                href="https://lexi-lambda.github.io/blog/2019/11/05/parse-don-t-validate/"
                rel="external"
              >
                Parse, donâ€™t validate
              </a>
            </div>
            <div class="description">
              <p>
                Now I have a single, snappy slogan that encapsulates what
                type-driven design means to me, and better yet, itâ€™s only three
                words long:<br />Parse, donâ€™t validate.
              </p>
            </div>
            <div class="author">Alexis King</div>
            <img
              class="portrait"
              src="assets/images/alexis-king.jpg"
              alt="Alexis King"
            />
          </div>
        </section>

        <section data-background-image="jim-carrey-typing.gif">
          <h2>Câ€™est partiÂ !</h2>
        </section>

        <section>
          <h2>Le domaine des possibilitÃ©s</h2>
          <pre><code data-trim data-line-numbers class="language-python">
            from collections.abc import Sequence

            def head[T](seq: Sequence[T]) -> T:
                return seq[0]
          </code></pre>
          <div class="fragment">
            <pre><code data-trim data-line-numbers class="language-python">
              head([])
            </code></pre>
            <pre><code data-trim class="language-plaintext">
              IndexError: list index out of range
            </code></pre>
          </div>
          <div class="fragment">
            <p>
              La fonction est <strong>partielle</strong> :<br />
              toutes les entrÃ©es possibles ne sont pas prises en compte.
            </p>
          </div>
        </section>

        <section>
          <h2>Fonction totale</h2>
          <p>Toutes les entrÃ©es possibles sont prises en compte.</p>
          <p class="fragment">
            Il y a 2 solutions pour rendre notre fonction totale.
          </p>
        </section>

        <section data-auto-animate>
          <h3>Solution 1Â : gÃ©rer la sÃ©quence vide</h3>
          <pre
            data-id="code-solution-1"
          ><code data-trim data-line-numbers class="language-python">
            from collections.abc import Sequence

            def head[T](seq: Sequence[T]) -> T | None:
                if not seq:
                    return None
                return seq[0]
          </code></pre>
          <div class="fragment">
            <pre><code data-trim data-line-numbers class="language-python">
              print(head([]))
              print(head([1, 2, 3]))
            </code></pre>
            <pre><code data-trim class="language-plaintext">
              None
              1
            </code></pre>
          </div>
        </section>

        <section data-auto-animate data-visibility="hidden">
          <h3>Solution 1Â : gÃ©rer la sÃ©quence vide</h3>
          <pre
            data-id="code-solution-1"
          ><code data-trim data-line-numbers class="language-python">
            from collections.abc import Sequence
            from typing import NewType

            NothingType = NewType("NothingType", str)
            Nothing = NothingType("Nothing")

            def head[T](seq: Sequence[T]) -> T | NothingType:
                if not seq:
                    return Nothing
                return seq[0]
          </code></pre>
          <div class="fragment">
            <pre><code data-trim data-line-numbers class="language-python">
              print(head([]))
              print(head([1, 2, 3]))
              print(head([None]))
            </code></pre>
            <pre><code data-trim class="language-plaintext">
              Nothing
              1
              None
            </code></pre>
          </div>
        </section>

        <section data-auto-animate>
          <h3>Solution 1Â : gÃ©rer la sÃ©quence vide</h3>
          <p class="small">
            Utilisons <code>head</code> pour obtenir le premier rÃ©pertoire d'une
            liste.
          </p>
          <pre
            data-id="code-solution-1"
          ><code data-trim data-line-numbers="6-9|12-19|22-31|23-24|25-29|17-18,25-29|30-31|22-31" class="language-python">
            import os
            from collections.abc import Sequence
            from pathlib import Path


            def head[T](seq: Sequence[T]) -> T | None:
                if not seq:
                    return None
                return seq[0]


            def get_config_directories() -> Sequence[Path]:
                config_dirs_string = os.getenv("CONFIG_DIRS", "")
                config_dirs = [
                    Path(d) for d in config_dirs_string.split(",") if d
                ]
                if not config_dirs:
                    raise ValueError("CONFIG_DIRS cannot be empty")
                return config_dirs


            def main() -> None:
                config_dirs = get_config_directories()
                match head(config_dirs):
                    case None:
                        raise ValueError(
                            "should never happen; "
                            "already checked config_dirs is non-empty"
                        )
                    case cache_dir:
                        initialize_cache(cache_dir)


            def initialize_cache(cache_dir: Path) -> None: ...


            if __name__ == "__main__":
                main()
          </code></pre>
        </section>

        <section data-auto-animate>
          <h3>Solution 1Â : gÃ©rer la sÃ©quence vide</h3>
          <p>Les problÃ¨mes</p>
          <ul class="solution-1-problems">
            <li>
              <span data-id="problem1">ğŸ˜®â€ğŸ’¨ VÃ©rifications redondantes</span>
              <ul class="small arrow-list">
                <li>potentielle dÃ©gradation de la performance</li>
              </ul>
            </li>
          </ul>
          <pre><code data-trim data-line-numbers="17-18,25-29" class="language-python small">
            import os
            from collections.abc import Sequence
            from pathlib import Path


            def head[T](seq: Sequence[T]) -> T | None:
                if not seq:
                    return None
                return seq[0]


            def get_config_directories() -> Sequence[Path]:
                config_dirs_string = os.getenv("CONFIG_DIRS", "")
                config_dirs = [
                    Path(d) for d in config_dirs_string.split(",") if d
                ]
                if not config_dirs:
                    raise ValueError("CONFIG_DIRS cannot be empty")
                return config_dirs


            def main() -> None:
                config_dirs = get_config_directories()
                match head(config_dirs):
                    case None:
                        raise ValueError(
                            "should never happen; "
                            "already checked config_dirs is non-empty"
                        )
                    case cache_dir:
                        initialize_cache(cache_dir)


            def initialize_cache(cache_dir: Path) -> None: ...


            if __name__ == "__main__":
                main()
          </code></pre>
        </section>

        <section data-auto-animate>
          <h3>Solution 1Â : gÃ©rer la sÃ©quence vide</h3>
          <p>Les problÃ¨mes</p>
          <ul class="solution-1-problems">
            <li>
              <span data-id="problem1">ğŸ˜®â€ğŸ’¨ VÃ©rifications redondantes</span>
              <ul class="small arrow-list">
                <li>potentielle dÃ©gradation de la performance</li>
              </ul>
            </li>
            <li>ğŸ› <strong>Un risque de bug Ã  venir</strong></li>
          </ul>
        </section>

        <section data-auto-animate>
          <h3>Solution 1Â : gÃ©rer la sÃ©quence vide</h3>
          <p class="small">Apparition d'un bug ğŸ›</p>
          <pre
            data-id="code-solution-1"
          ><code data-trim data-line-numbers="17-18,25-29|12-19" class="language-python">
            import os
            from collections.abc import Sequence
            from pathlib import Path


            def head[T](seq: Sequence[T]) -> T | None:
                if not seq:
                    return None
                return seq[0]


            def get_config_directories() -> Sequence[Path]:
                config_dirs_string = os.getenv("CONFIG_DIRS", "")
                config_dirs = [
                    Path(d) for d in config_dirs_string.split(",") if d
                ]
                if not config_dirs:
                    raise ValueError("CONFIG_DIRS cannot be empty")
                return config_dirs


            def main() -> None:
                config_dirs = get_config_directories()
                match head(config_dirs):
                    case None:
                        raise ValueError(
                            "should never happen; "
                            "already checked config_dirs is non-empty"
                        )
                    case cache_dir:
                        initialize_cache(cache_dir)


            def initialize_cache(cache_dir: Path) -> None: ...


            if __name__ == "__main__":
                main()
          </code></pre>
        </section>

        <section data-auto-animate>
          <h3>Solution 1Â : gÃ©rer la sÃ©quence vide</h3>
          <p class="small">Apparition d'un bug ğŸ›</p>
          <pre
            data-id="code-solution-1"
          ><code data-trim data-line-numbers="12-19|12-17,23-24|6-9" class="language-python">
            import os
            from collections.abc import Sequence
            from pathlib import Path


            def head[T](seq: Sequence[T]) -> T | None:
                if not seq:
                    return None
                return seq[0]


            def get_config_directories() -> Sequence[Path]:
                config_dirs_string = os.getenv("CONFIG_DIRS", "")
                config_dirs = [
                    Path(d) for d in config_dirs_string.split(",") if d
                ]
                return config_dirs


            def main() -> None:
                config_dirs = get_config_directories()
                match head(config_dirs):
                    case None:
                        raise ValueError("Hello! Iâ€™m a new bug!")
                    case cache_dir:
                        initialize_cache(cache_dir)


            def initialize_cache(cache_dir: Path) -> None: ...


            if __name__ == "__main__":
                main()
          </code></pre>
        </section>

        <section data-auto-animate data-auto-animate-restart>
          <h3>Solution 2Â : interdire la sÃ©quence vide</h3>
          <div class="fragment" data-fragment-index="0">
            <pre
              data-id="code-solution-2"
            ><code data-trim data-line-numbers="|3-4|7-8" class="language-python" data-fragment-index="1">
              from typing import TypeVar, Unpack

              T = TypeVar("T")
              NonEmptyTuple = tuple[T, Unpack[tuple[T, ...]]]


              def head(seq: NonEmptyTuple[T]) -> T:
                  return seq[0]
            </code></pre>
          </div>
          <div class="fragment" data-fragment-index="1">
            <p class="small">
              <a
                href="https://www.aazuspan.dev/blog/type-safety-and-non-empty-tuples-in-python/"
                rel="external"
              >
                Type Safety and Non-Empty Tuples in Python
              </a>
              â€” Aaron Zuspan
            </p>
          </div>
        </section>

        <section data-auto-animate>
          <h3>Solution 2Â : interdire la sÃ©quence vide</h3>
          <pre
            data-id="code-solution-2"
          ><code data-trim data-line-numbers class="language-python">
            from typing import TypeVar, Unpack

            T = TypeVar("T")
            NonEmptyTuple = tuple[T, Unpack[tuple[T, ...]]]


            def head(seq: NonEmptyTuple[T]) -> T:
                return seq[0]
          </code></pre>
          <pre><code data-trim data-line-numbers class="language-python">
            print(head((1, 2, 3)))  # Output: 1
            print(head(tuple()))    # Raises IndexError
          </code></pre>
          <div class="fragment">
            <p>
              Utilisons un vÃ©rificateur de type statique
              <a href="https://www.mypy-lang.org/" rel="external">
                <img
                  class="mypy-logo"
                  src="assets/images/mypy.svg"
                  alt="mypy logo"
                />
              </a>
            </p>
            <pre><code data-trim class="language-bash">
              mypy .
            </code></pre>
            <pre class="output"><code data-trim class="language-plaintext wrap">
              Argument 1 to "head" has incompatible type "tuple[Never, ...]"; expected "tuple[Never, *tuple[Never, ...]]"  [arg-type]
            </code></pre>
          </div>
        </section>

        <section data-auto-animate>
          <h3>Solution 2Â : interdire la sÃ©quence vide</h3>
          <p class="small">
            Utilisons <code>head</code> pour obtenir le premier rÃ©pertoire d'une
            liste.
          </p>
          <pre
            data-id="code-solution-2"
          ><code data-trim data-line-numbers="1-10|13-20|18,23-26|29-31" class="language-python">
            import os
            from pathlib import Path
            from typing import TypeGuard, TypeVar, Unpack

            T = TypeVar("T")
            NonEmptyTuple = tuple[T, Unpack[tuple[T, ...]]]


            def head(seq: NonEmptyTuple[T]) -> T:
                return seq[0]


            def get_config_directories() -> NonEmptyTuple[Path]:
                config_dirs_string = os.getenv("CONFIG_DIRS", "")
                config_dirs = tuple(
                    Path(d) for d in config_dirs_string.split(",") if d
                )
                if not is_non_empty(config_dirs):
                    raise ValueError("CONFIG_DIRS cannot be empty")
                return config_dirs


            def is_non_empty(
                seq: tuple[T, ...]
            ) -> TypeGuard[NonEmptyTuple[T]]:
                return len(seq) > 0


            def main() -> None:
                config_dirs = get_config_directories()
                initialize_cache(head(config_dirs))


            def initialize_cache(cache_dir: Path) -> None: ...


            if __name__ == "__main__":
                main()
          </code></pre>
        </section>

        <section>
          <div class="columnContainer">
            <div class="column">
              <p class="heading">
                GÃ©rer la sÃ©quence vide<br />
                en retournant <code>None</code><br />
                <small>Solution 1</small>
              </p>
              <ul>
                <li>
                  ğŸ˜®â€ğŸ’¨ VÃ©rifications redondantes<br />
                  <small>(avec un coÃ»t de performance potentiel)</small>
                </li>
                <li>ğŸ› Un bug est probable Ã  lâ€™avenir</li>
              </ul>
            </div>
            <div class="column">
              <p class="heading">
                Interdire la sÃ©quence vide<br />
                avec un <strong>nouveau type</strong> âœ¨<br />
                <small>Solution 2</small>
              </p>
              <ul>
                <li style="margin-bottom: 1.35em">ğŸ™‚ Une seule vÃ©rification</li>
                <li>âœ… Le typage empÃªche des erreurs</li>
              </ul>
            </div>
          </div>
        </section>

        <section data-background-image="obama-wtf.gif" data-auto-animate>
          <h2 class="r-fit-text">Parse, donâ€™t validate</h2>
          <p>Qu'est ce que Ã§a veut direÂ ?</p>
        </section>

        <section data-auto-animate>
          <h2><span class="erased">Parse, donâ€™t</span> validate</h2>
          <p>Envoi dâ€™un message Ã  un numÃ©ro de tÃ©lÃ©phone</p>
          <pre
            data-id="phone-number"
          ><code data-trim data-line-numbers="|1-2|5-8" data-fragment-index="0" class="language-python">
            def validate_phone_number(text: str) -> bool:
                return len(text) == 10 and text.isdigit()


            def send_message(phone_number: str, message: str) -> None:
                if not validate_phone_number(phone_number):
                    raise ValueError("Invalid phone number")
                print(f"Sending message to {phone_number}: {message}")
          </code></pre>
          <p class="fragment" data-fragment-index="1">
            Le numÃ©ro de tÃ©lÃ©phone est une chaÃ®ne de caractÃ¨res, par prÃ©caution
            on vÃ©rifie son format Ã  chaque envoi.
          </p>
        </section>

        <section data-auto-animate>
          <h2><strong>Parse</strong>, donâ€™t validate</h2>
          <p>Envoi dâ€™un message Ã  un numÃ©ro de tÃ©lÃ©phone</p>
          <pre
            data-id="phone-number"
          ><code data-trim data-line-numbers="|6-9|12-15" data-fragment-index="0" class="language-python">
            from typing import NewType

            ValidPhoneNumber = NewType("ValidPhoneNumber", str)


            def parse_phone_number(text: str) -> ValidPhoneNumber:
                if len(text) != 10 and not text.isdigit():
                    raise ValueError("Invalid phone number")
                return ValidPhoneNumber(text)


            def send_message(
                phone_number: ValidPhoneNumber, message: str
            ) -> None:
                print(f"Sending message to {phone_number}: {message}")
          </code></pre>
          <p class="fragment" data-fragment-index="1">
            Le type indique que le numÃ©ro est valide, plus besoin de vÃ©rifier
            son format Ã  chaque envoi.
          </p>
        </section>

        <section data-auto-animate class="conclusion">
          <h1>Parse, donâ€™t validate</h1>
          <ul>
            <li class="fragment">Validez quâ€™une fois vos donnÃ©es Ã  l'entrÃ©e</li>
            <li class="fragment">
              Conservez lâ€™information avec des types<br />
              <span class="small">(stop Ã  la primitive obsession)</span>
            </li>
            <li class="fragment">
              Des bugs Ã©vitÃ©s grÃ¢ce au typage avant mÃªme dâ€™exÃ©cuter le code<br />
              <span class="small"
                >(IDE, compilation ou analyse statique de code)</span
              >
            </li>
          </ul>
        </section>

        <section>
          <h2>Merci</h2>
          <div class="slides-link">
            <p>Les slides sont en ligne.</p>
            <a href="https://brvoisin.github.io/talk-parse-don-t-validate/">
              <img src="assets/images/qrcode.svg" alt="QR Code" />
            </a>
          </div>
          <p class="powered-by">
            PropulsÃ© par
            <a href="https://revealjs.com/" rel="external">
              <img src="assets/images/revealjs.svg" alt="Reveal.js" />
            </a>
          </p>
          <p class="sources">
            Sources sur
            <a href="https://github.com/brvoisin/talk-parse-don-t-validate">
              <img src="assets/images/github-mark.svg" alt="GitHub mark" /><img
                src="assets/images/GitHub_Logo.png"
                alt="GitHub logo"
              />
            </a>
          </p>
        </section>
      </div>
    </div>
    <script type="module" src="/main.js"></script>
  </body>
</html>
